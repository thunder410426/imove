<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>修改电影信息</title>
		<meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="../static/css/bootstrap.min.css" />
		<link rel="stylesheet" href="../static/css/bootstrap-responsive.min.css" />
		<link rel="stylesheet" href="../static/css/unicorn.main.css" />
		<link rel="stylesheet" href="../static/css/unicorn.grey.css" class="skin-color" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
	<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<div id="header">
		<h1><a href="../dashboard.html">Unicorn Admin</a></h1>
	</div>

	<div id="search">
		<input type="text" placeholder="Search here..."><button type="submit" class="tip-right" data-original-title="Search"><i class="icon-search icon-white"></i></button>
	</div>
	<div id="user-nav" class="navbar navbar-inverse">
		<ul class="nav btn-group" style="width: auto; margin: 0px;">
			<li class="btn btn-inverse"><a title="" href="#"><i class="icon icon-user"></i> <span class="text">Profile</span></a></li>
			<li class="btn btn-inverse dropdown" id="menu-messages"><a href="#" data-toggle="dropdown" data-target="#menu-messages" class="dropdown-toggle"><i class="icon icon-envelope"></i> <span class="text">Messages</span> <span class="label label-important">5</span> <b class="caret"></b></a>
				<ul class="dropdown-menu">
					<li><a class="sAdd" title="" href="#">new message</a></li>
					<li><a class="sInbox" title="" href="#">inbox</a></li>
					<li><a class="sOutbox" title="" href="#">outbox</a></li>
					<li><a class="sTrash" title="" href="#">trash</a></li>
				</ul>
			</li>
			<li class="btn btn-inverse"><a title="" href="#"><i class="icon icon-cog"></i> <span class="text">Settings</span></a></li>
			<li class="btn btn-inverse"><a title="" href="major/ga/login.html"><i class="icon icon-share-alt"></i> <span class="text">Logout</span></a></li>
		</ul>
	</div>

	<div id="sidebar">
		<a href="#" class="visible-phone"><i class="icon icon-tint"></i> Buttons &amp; icons</a>
		<ul style="display: block;">
			<li><a href="index.html"><i class="icon icon-home"></i> <span>Dashboard</span></a></li>

			<li><a href="/retrieveType"><i class="icon-th"></i> <span>分类管理</span></a></li>

			<li><a href="/upload1"><i class="icon-circle-arrow-up"></i> <span>影片上传</span></a></li>

			<li class="submenu">
				<a href="#"><i class="icon-search"></i> <span>影片查找</span> <span class="label">2</span></a>
				<ul>
					<li><a href="/retrievebyName">以电影名查找</a></li>
					<li><a href="/retrievebyType">以电影类别查找</a></li>
				</ul>
			</li>

			<li class="active open"><a href="/retrieveMsg"><i class="icon icon-file"></i> <span>影片管理</span></a></li>

			<li><a href="/retrieveNews"><i class="icon-fire"></i> <span>新闻管理</span></a></li>
		</ul>
	</div>

	<div id="style-switcher">
		<i class="icon-arrow-left icon-white"></i>
		<span>Style:</span>
		<a href="#grey" style="background-color: #555555;border-color: #aaaaaa;"></a>
		<a href="#blue" style="background-color: #2D2F57;"></a>
		<a href="#red" style="background-color: #673232;"></a>
	</div>

	<div id="content">
		<div id="content-header">
			<h1>影片浏览&管理</h1>
			<div class="btn-group" style="width: auto;">
				<a class="btn btn-large tip-bottom" data-original-title="Manage Files"><i class="icon-file"></i></a>
				<a class="btn btn-large tip-bottom" data-original-title="Manage Users"><i class="icon-user"></i></a>
				<a class="btn btn-large tip-bottom" data-original-title="Manage Comments"><i class="icon-comment"></i><span class="label label-important">5</span></a>
				<a class="btn btn-large tip-bottom" data-original-title="Manage Orders"><i class="icon-shopping-cart"></i></a>
			</div>
		</div>
		<div id="breadcrumb">
			<a href="#" class="tip-bottom" data-original-title="Go to Home"><i class="icon-home"></i> Home</a>
			<a href="#" class="current">影片浏览</a>
		</div>
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="container-fluid">
					<div class="row-fluid">
						<div class="span6">
							<div class="widget-box">
								<div class="widget-title">
								<span class="icon">
									<i class="icon-file"></i>
								</span>
									<h5>Recent Posts</h5>
								</div>
								<div class="widget-content nopadding" th:each="movie:${movieList}">
									<ul class="recent-posts">
										<li>
											<div class="user-thumb" style="width: 180px;height: 230px;">
												<img alt="电影海报" th:src="@{${movie.picname}}"  style="height: 230px;width: 250px;">
											</div>
											<div class="article-post" style="width: 600px;">
												<span class="user-info"><div><h3 th:text="${movie.name}" id="msg-name-removed" name="msg-name-removed"></h3></div></span>
												<div style="display: inline-flex"><span>电影类别：</span><a th:text="${movie.type}" id="msg-type-removed"></a></div><br>
												<div style="display: inline-flex"><span>上映时间：</span><a th:text="${movie.date}" id="msg-date-removed"></a></div><br>
												<div style="display: inline-flex"><span>演员：</span><a th:text="${movie.actors}" id="msg-actors-removed"></a></div><br>
												<div style="display: inline-flex"><span>简介：</span><a style="width: 300px" th:text="${movie.introduction}" id="msg-introductions-removed"></a></div><br>
												<!--<div style="display: none"><span>电影图片：</span><a style="width: 300px" th:text="${movie.picname}" id="msg-picname"></a></div><br>
												<div style="display: none"><span>电影文件：</span><a style="width: 300px" th:text="${movie.filename}" id="msg-filename"></a></div><br>-->
												<p></p>
												<h4 class="btn btn-warning" style="width: 50px;height: 30px;margin-top: 100px;"
													 data-toggle="modal" data-target="#exampleModal">修改</h4>

												<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
													<div class="modal-dialog" role="document">
														<div class="modal-content">
															<div class="modal-header">
																<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
																<h4 class="modal-title" id="exampleModalLabel">修改电影信息</h4>
															</div>
															<div class="modal-body">
																<form>
																	<div class="form-group">
																		<label class="control-label">电影名：</label>
																		<input type="text" class="form-control" style="width: 400px" id="msg-name">
																	</div>
																	<div class="form-group">
																		<label class="control-label">电影类别：</label>
																		<input type="text" class="form-control" style="width: 400px" id="msg-type">
																	</div>
																	<div class="form-group">
																		<label class="control-label">上映时间</label>
																		<input type="text" class="form-control" style="width: 400px" id="msg-date">
																	</div>
																	<div class="form-group">
																		<label class="control-label">演员</label>
																		<input type="text" class="form-control" style="width: 400px" id="msg-actors">
																	</div>
																	<div class="form-group">
																		<label class="control-label">简介</label>
																		<textarea type="" class="form-control" style="width: 400px" id="msg-introduction"></textarea>
																	</div>
																	<div class="form-group" style="display: none">
																		<label class="control-label">简介</label>
																		<textarea type="" class="form-control" style="width: 400px" th:text="${movie.picname}" id="msg-picname"></textarea>
																	</div>
																	<div class="form-group" style="display: none">
																		<label class="control-label">简介</label>
																		<textarea type="" class="form-control" style="width: 400px" th:text="${movie.filename}" id="msg-filename"></textarea>
																	</div>
																</form>
															</div>
															<div class="modal-footer">
																<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
																<button type="button" class="btn btn-primary" onclick="updateMsg()">修改</button>
															</div>
														</div>
													</div>
												</div>
												<h4 href="#" class="btn btn-danger" style="margin-top: 100px;width: 50px;height: 30px;" onclick="deleteMsg()">删除</h4>
											</div>

										</li>

									</ul>
								</div>
							</div>
							</div>
						</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>



		function updateMsg() {
			var name2 = $("#msg-name").val();
			var type2 = $("#msg-type").val();
			var date2 = $("#msg-date").val();
			var actors2 = $("#msg-actors").val();
			var introduction2 = $("#msg-introduction").val();
			var picname2 = $("#msg-picname").val();
			var filename2 = $("#msg-filename").val();
			var nameremoved = document.getElementById("msg-name-removed").innerHTML;

			console.log(name2);
			console.log(type2);
			console.log(date2);
			console.log(actors2);
			console.log(introduction2);
			console.log(nameremoved);
			console.log(picname2);
			console.log(filename2);

			$.ajax({
				url: "/updateMsg",
				data: {'name':name2,'type':type2,'date':date2,'actors':actors2,'introduction':introduction2,'picname':picname2,'filename':filename2,'nameremoved':nameremoved},
				dataType: "JSON",
				method: "POST",
				success:function (data) {
					window.location.href="/retrieveMsg";
				}
			});
		}

		function deleteMsg() {
			var nameremoved = document.getElementById("msg-name-removed").innerHTML;
			$.ajax({
				url: "/deleteMsg",
				data: {'nameremoved':nameremoved},
				dataType: "JSON",
				method: "POST",
				success:function (data) {
					window.location.href="/retrieveMsg"
					alert("删除成功")
				},
				error:function () {
					window.location.href="/retrieveMsg"
					alert("删除成功！")
				}
			})
		}
	</script>

	<script src="../static/js/jquery.min.js"></script>
	<script src="../static/js/jquery.ui.custom.js"></script>
	<script src="../static/js/bootstrap.min.js"></script>
	<script src="../static/js/jquery.validate.js"></script>
	<script src="../static/js/jquery.wizard.js"></script>
	<script src="../static/js/unicorn.js"></script>
	<script src="../static/js/unicorn.wizard.js"></script>


	<ul class="typeahead dropdown-menu"></ul>
</html>
